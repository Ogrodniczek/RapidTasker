<!DOCTYPE HTML>
<html>
    <head>
    <title>RapidTasker</title>
    <script type="text/javascript" src="//code.jquery.com/jquery-2.1.1.min.js"></script>
    <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/socket.io/0.9.16/socket.io.min.js"></script>
    <script type="text/javascript" charset="utf-8">
        $(document).ready(function(){
            namespace = '/test';
            var socket = io.connect('http://' + document.domain + ':' + location.port + namespace);

            socket.on('add_task', function(msg) {
                var new_task = $(msg.new_code).hide();
                $('#tasks_main').prepend(new_task);
                new_task.slideDown();
                });

            socket.on('log', function(msg) {
                $('#log').append('<br>'+msg.data);
                });

            socket.on('replace_task', function(msg) {
                $('.tasks#'+msg.id).replaceWith(msg.new_code);
                });


            ///TO THE SERVER SITE!
            $('form#username').submit(function(event) {
                $('#username').hide();
                $('#tasks_main').show();
                //$('#add_task_manually').show();
                socket.emit('username', {username: $('#username_field').val()});
                return false;
                });
            
            $('#tasks_main').on('click', 'input.claim', function(event){
                    socket.emit('take_task', {id: $(this).parent().attr('id'), user: $('#username_field').val()});
                    });
            $('body').on('click', 'input.solved', function(event){
                    socket.emit('end_task', {id: $(this).parent().attr('id'), user: $('#username_field').val()});
                    });
        });
    </script>
</head>
<body>
    <div id="username">
    <form id="username" method='POST' action='#'>
        <input type="text" name="username_field" id="username_field" placeholder="User">
        <input type="submit" value="GO!"></div>
    </form>
    </div>
    <div id="add_task_manually" style="display: none;">
    <form id="add_task_manually" method='POST' action='#'>
        <input type="text" name="task_desctiption" id="task_description" placeholder="Task description">
        <input type="submit" value="Post"></div>
    </form>
    </div>
    <div id='tasks_main' style="display: none;">
    </div>
<div id="log"></div>
</body>
</html>
